# SpringAOP

Проект, предназначенный для знакомства с AOP

## Описание

Разработана система учета времени выполнения методов в приложении с использованием Spring AOP.
Система асинхронно логирует и анализирует данные о времени выполнения методов,
помеченных аннотациями @TrackTime и @TrackAsyncTime. Система работает на основе аспектов, которые отслеживают работу
методов и заносят данные о каждом выполнении в бд. Реализовано REST API для получения статистики по времени выполнения методов.
Api описано ниже.

## Установка и запуск

1. Склонируйте репозиторий: `git clone https://github.com/AntonAshutov/AOPproject.git`
2. Убедитесь, что на вашем компьютере установлен Maven
3. Откройте  проект в вашей IDE
4. Убедитесь что на вашем компьтере запущен Postgres в соответствии с настройками, указанными в файле application.yaml
    По умолчанию это порт 5432, бд имеет название postgres, пользователь postgres, пароль 12345
5. Убедитесь что порт 8080 вашего компьютера свободен или установите другой в application.yaml
6. Запустите проект

## Технологии

- Spring AOP
- PostgreSQL
- Lombok
- REST API

## API Endpoints

### Получить общую информацию для каждого метода

```
GET /api/v1/stats/
```

Возвращает общую информацию о каждом методе, включая количество вызовов и среднее время выполнения в миллисекундах.

#### Ответ

```json
{
  "info": [
    {
      "methodName": "exampleMethod",
      "callQuantity": 10,
      "avgRunningTime": 5.2
    },
    {
      "methodName": "anotherMethod",
      "callQuantity": 15,
      "avgRunningTime": 3.8
    },
    ...
  ]
}
```

### Получить список имен методов, информация о которых есть в бд

```
GET /api/v1/stats/methodNames
```

Возвращает список имен всех методов, для которых собрана статистика выполнения.

#### Ответ

```json
{
  "methodNames": [
    "exampleMethod",
    "anotherMethod",
    ...
  ]
}
```

### Получить подробную информацию для каждого метода

```
GET /api/v1/stats/detailed
```

Возвращает подробную информацию о каждом методе, включая количество вызовов, минимальное, максимальное, среднее и медианное время выполнения в миллисекундах.

#### Ответ

```json
{
  "info": [
    {
      "methodName": "exampleMethod",
      "callQuantity": 10,
      "minRunningTime": 1.2,
      "maxRunningTime": 7.5,
      "avgRunningTime": 5.2,
      "medianRunningTime": 5.0
    },
    {
      "methodName": "anotherMethod",
      "callQuantity": 15,
      "minRunningTime": 0.8,
      "maxRunningTime": 4.5,
      "avgRunningTime": 3.8,
      "medianRunningTime": 3.6
    },
    ...
  ]
}
```

### Получить подробную информацию для конкретного метода

```
GET /api/v1/stats/detailed/{methodName}
```

Возвращает подробную информацию о заданном методе, включая количество вызовов, минимальное, максимальное, среднее и медианное время выполнения в миллисекундах.

#### Параметры пути

| Параметр | Тип     | Описание                                      |
|----------|---------|-----------------------------------------------|
| `methodName` | `string` | **Обязательный**. Имя метода, для которого требуется информация. |

#### Ответы

- `200 OK` при успешном запросе

```json
{
  "methodName": "exampleMethod",
  "callQuantity": 10,
  "minRunningTime": 1.2,
  "maxRunningTime": 7.5,
  "avgRunningTime": 5.2,
  "medianRunningTime": 5.0
}
```

- `400 Bad Request` если метод с заданным именем не найден

```json
"method stats not found"
```

